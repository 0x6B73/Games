<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=1" />
<title>Nozruc‚Äôs Neon Jackpots ‚Äî Player+EV Default</title>
<meta name="theme-color" content="#00e5ff" />
<style>
  :root{
    --neon1:#00e5ff; --neon2:#ff2fd3; --neon3:#89ff00; --neon4:#ffb300;
    --text:#e7f8ff; --muted:#9ed1df; --gap: clamp(8px,2.5vw,14px);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--text);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
    font-size:16px; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    background: radial-gradient(1200px 900px at 50% 10%, #001018 0%, #02040a 45%, #000 80%);
    -webkit-tap-highlight-color:transparent;
    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
  }
  .container{max-width:1000px; margin:0 auto; padding:16px}

  .logo{font-size:clamp(28px,7vw,56px); font-weight:900; text-align:center; letter-spacing:.6px;
    background:linear-gradient(90deg,var(--neon1),var(--neon2),var(--neon4));
    -webkit-background-clip:text;background-clip:text;color:transparent;
    text-shadow:0 0 22px rgba(0,229,255,.35)}
  .marquee{height:7px; margin:10px auto 0; max-width:min(680px,92%);
    background:linear-gradient(90deg,#012,#024 30%,#013 60%,#012); border-radius:999px; position:relative; overflow:hidden}
  .marquee::before{content:""; position:absolute; inset:-50% auto auto -30%; width:60%; height:220%;
    background:conic-gradient(from 0deg, var(--neon2), var(--neon1), var(--neon3), var(--neon4), var(--neon2));
    filter:blur(12px) saturate(160%); opacity:.9; animation:sweep 3.5s linear infinite; pointer-events:none}
  @keyframes sweep{to{transform:translateX(250%)}}

  .stage{position:relative; isolation:isolate; margin:16px auto; padding:16px;
    border:1px solid rgba(0,229,255,.25); border-radius:16px;
    background:linear-gradient(180deg,rgba(0,229,255,.06),rgba(255,47,211,.05));
    box-shadow:0 10px 30px rgba(0,0,0,.55)}
  .topbar{display:grid; grid-template-columns:repeat(3,1fr); gap:var(--gap);
    padding:8px; border:1px solid rgba(0,229,255,.2); border-radius:12px;
    background:linear-gradient(180deg,rgba(0,229,255,.08),rgba(255,47,211,.06))}
  .chip{display:flex; align-items:center; justify-content:center; gap:8px; min-height:44px; padding:10px;
    border-radius:999px; background:rgba(0,229,255,.08); border:1px solid rgba(0,229,255,.25);
    box-shadow:inset 0 0 10px rgba(0,229,255,.2); font-weight:800; white-space:nowrap; overflow:hidden}
  .chip .dot{width:10px; height:10px; border-radius:999px; background:var(--neon1); box-shadow:0 0 10px var(--neon1),0 0 20px var(--neon1)}

  .reels{display:grid; grid-template-columns:repeat(3,1fr); gap:var(--gap); margin:var(--gap) auto; max-width:760px}
  .reel{position:relative; height:clamp(120px,32vw,210px); border-radius:14px;
    background:radial-gradient(260px 110px at 50% -20%, rgba(255,179,0,.2), rgba(255,47,211,.08)),
               linear-gradient(180deg,#0b1c28,#06141d 40%,#0b1c28);
    border:1px solid rgba(0,229,255,.25); box-shadow:inset 0 -30px 60px rgba(0,0,0,.45), 0 6px 18px rgba(0,0,0,.35); overflow:hidden}
  .window{position:absolute; inset:10px; border-radius:10px; display:flex; align-items:center; justify-content:center;
    background:linear-gradient(180deg,rgba(0,0,0,.4),rgba(0,0,0,.65)); border:1px solid rgba(255,255,255,.06);
    font-size:clamp(44px,12vw,80px); text-shadow:0 0 14px rgba(255,255,255,.3)}
  #fx{position:absolute; inset:0; pointer-events:none; border-radius:inherit}

  .message{min-height:28px; text-align:center; margin:6px 0 2px; font-weight:900; color:#bfefff}

  /* Controls: SPIN on top (mobile-first) */
  .controls{
    display:grid; gap:var(--gap);
    grid-template-columns:repeat(4,1fr);
    grid-template-areas:
      "spin  spin  spin  spin"
      "minus bet   bet   plus"
      "max   max   bonus bonus"
      "odds  odds  odds  odds";
    max-width:900px; margin:0 auto;
  }
  button, .input{
    padding:14px; min-height:48px; border-radius:12px; font-weight:900; letter-spacing:.35px;
    border:1px solid rgba(0,229,255,.35); color:var(--text);
    background:linear-gradient(180deg,rgba(0,229,255,.1),rgba(255,47,211,.06));
    box-shadow:0 8px 18px rgba(0,0,0,.35), inset 0 0 16px rgba(0,229,255,.15);
  }
  button:active{transform:translateY(1px)}
  .input{width:100%; text-align:center; background:#07121a; font-size:16px}
  #spinBtn{grid-area:spin; border-color:rgba(137,255,0,.45)}
  #betDown{grid-area:minus} #betInput{grid-area:bet} #betUp{grid-area:plus}
  #maxBtn{grid-area:max} #bonusBtn{grid-area:bonus} #oddsBtn{grid-area:odds}

  /* Wide screens: tidy two-row layout */
  @media (min-width: 721px){
    .controls{
      grid-template-columns:repeat(6,1fr);
      grid-template-areas:
        "minus bet bet plus spin spin"
        "max   max bonus bonus odds odds";
    }
  }

  /* Bottom sheet */
  .sheet{position:fixed; inset:auto 0 0 0; z-index:9999; background:#0a1118; color:var(--text);
    border-top-left-radius:18px; border-top-right-radius:18px; border:1px solid rgba(0,229,255,.25);
    transform:translateY(110%); transition:transform .28s ease; max-height:82dvh; overflow:auto; padding:16px}
  .sheet.open{transform:translateY(0)}
  .badge{display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px;
    background:rgba(0,229,255,.08); border:1px solid rgba(0,229,255,.25); font-weight:800; margin:0 8px 8px 0}
  .warn{color:#ff6b6b; font-weight:900}
</style>
</head>
<body>
<div class="container">
  <div class="logo">Nozruc‚Äôs Neon Jackpots</div>
  <div class="marquee" aria-hidden="true"></div>

  <section class="stage" id="stage">
    <canvas id="fx"></canvas>

    <div class="topbar">
      <div class="chip"><span class="dot"></span> Credits: <strong id="credits">0</strong></div>
      <div class="chip"><span class="dot" style="background:var(--neon2)"></span> High: <strong id="high">0</strong></div>
      <div class="chip"><span class="dot" style="background:var(--neon4)"></span> Spins: <strong id="spins">0</strong></div>
    </div>

    <div class="reels">
      <div class="reel"><div class="window" id="r0">üçí</div></div>
      <div class="reel"><div class="window" id="r1">üçã</div></div>
      <div class="reel"><div class="window" id="r2">üîî</div></div>
    </div>

    <div class="message" id="message" role="status" aria-live="polite"></div>

    <div class="controls">
      <button id="spinBtn">SPIN ‚ú®</button>
      <button id="betDown">‚àí</button>
      <input id="betInput" class="input" type="number" min="1" max="100000" step="1" inputmode="numeric" pattern="[0-9]*" value="10" />
      <button id="betUp">Ôºã</button>
      <button id="maxBtn">Max</button>
      <button id="bonusBtn">Bonus</button>
      <button id="oddsBtn">Odds</button>
    </div>
  </section>
</div>

<!-- Odds & Settings -->
<aside id="sheet" class="sheet" role="dialog" aria-label="Odds & Settings">
  <h3 style="margin:0 0 8px">Odds & Settings</h3>
  <p style="margin:6px 0 12px; color:#cfe">
    Default favors the player: Base house edge <strong>-15%</strong> (RTP 115%). Adjust ¬±25 percentage points.
  </p>
  <div style="display:grid; gap:10px; grid-template-columns:repeat(auto-fit,minmax(220px,1fr))">
    <div>
      <label for="edgeSlider" style="font-weight:900; display:block; margin-bottom:6px">House Edge Adjustment</label>
      <input id="edgeSlider" type="range" min="-25" max="25" step="0.5" />
    </div>
    <div>
      <span class="badge">Base Edge: <span id="baseEdgeLabel">-15%</span></span>
      <span class="badge">Adjustment: <span id="edgeAdjLabel">0%</span></span>
      <span class="badge">Current Edge: <span id="edgeLabel">-15%</span></span>
      <span class="badge">Est. RTP: <span id="rtpLabel">115%</span></span>
    </div>
    <div><button id="edgeReset" style="width:100%">Reset Adjustment</button></div>
    <div><button id="resetBtn" style="width:100%; border-color:#ff8080">Reset Progress</button></div>
    <div><button id="closeSheet" style="width:100%">Close</button></div>
  </div>
  <p style="margin:12px 0 0; color:#cfe">Note: Small payouts below your bet are still losses (LDWs). The default math is player-favorable overall.</p>
</aside>

<script>
(() => {
  'use strict';

  /* ---------- Storage & state ---------- */
  const SAVE_KEY = 'NOZRUC_V11_PLAYER_PLUS';
  const META_KEY = 'NOZRUC_META_V2';
  const storage = (()=>{ try{ localStorage.setItem('_t','1'); localStorage.removeItem('_t'); return localStorage; }catch{ return {getItem:()=>null,setItem:()=>{},removeItem:()=>{}}; }})();
  const now = ()=>Date.now();

  // Player-favorable default; slider adjusts in percentage points
  const BASE_EDGE = -15;                 // %
  const SLIDER_RANGE = 25;               // ¬± points

  // Warm-up plan: guaranteed net-positive over first 5 spins (sum = 6.0x bet)
  const WARMUP_PLAN = [0.6, 0.8, 0.8, 0.8, 3.0];

  let meta = (()=>{ try{ return JSON.parse(storage.getItem(META_KEY))||{} }catch{ return {} }})();
  if (typeof meta.warmupIndex !== 'number') meta.warmupIndex = 0;
  function saveMeta(){ try{ storage.setItem(META_KEY, JSON.stringify(meta)); }catch{} }

  const defaultState=()=>({credits:500, bet:10, spins:0, high:500, lastBonus:0, edgeAdj:0});
  let state = load();
  function load(){ try{ const raw = storage.getItem(SAVE_KEY); if(!raw) return defaultState(); const s=JSON.parse(raw);
    if(!Number.isFinite(s.credits)||s.credits<0) s.credits=500;
    if(!Number.isFinite(s.bet)||s.bet<1) s.bet=10;
    if(!Number.isFinite(s.spins)||s.spins<0) s.spins=0;
    if(!Number.isFinite(s.high)||s.high<0) s.high=500;
    if(!Number.isFinite(s.lastBonus)||s.lastBonus<0) s.lastBonus=0;
    if(!Number.isFinite(s.edgeAdj)) s.edgeAdj=0; return s; }catch{ return defaultState(); }}
  function save(){ storage.setItem(SAVE_KEY, JSON.stringify(state)); }

  /* ---------- Elements ---------- */
  const $=id=>document.getElementById(id);
  const creditsEl=$('credits'), highEl=$('high'), spinsEl=$('spins'), msgEl=$('message'), stage=$('stage');
  const r=[ $('r0'), $('r1'), $('r2') ];
  const spinBtn=$('spinBtn'), betUp=$('betUp'), betDown=$('betDown'), maxBtn=$('maxBtn'), bonusBtn=$('bonusBtn'), betInput=$('betInput');
  const sheet=$('sheet'), oddsBtn=$('oddsBtn'), closeSheet=$('closeSheet'), edgeSlider=$('edgeSlider'), edgeReset=$('edgeReset');
  const baseEdgeLabel=$('baseEdgeLabel'), edgeAdjLabel=$('edgeAdjLabel'), edgeLabel=$('edgeLabel'), rtpLabel=$('rtpLabel');
  const fx=$('fx'), fxc=fx.getContext('2d');

  /* ---------- Audio ---------- */
  const AudioKit=(()=>{ const Ctx=window.AudioContext||window.webkitAudioContext; const ctx=new Ctx();
    let unlocked=false; const unlock=()=>{ if(!unlocked){ ctx.resume(); unlocked=true; } }; ['pointerdown','touchstart','click'].forEach(t=>addEventListener(t,unlock,{once:true}));
    const master=ctx.createGain(); master.gain.value=.22; master.connect(ctx.destination);
    const comp=ctx.createDynamicsCompressor(); comp.threshold.value=-22; comp.knee.value=20; comp.ratio.value=8; comp.attack.value=.003; comp.release.value=.25; comp.connect(master);
    const delay=ctx.createDelay(.6); delay.delayTime.value=.14; const dG=ctx.createGain(); dG.gain.value=.18; delay.connect(dG); dG.connect(comp);
    const chain=n=>{ n.connect(comp); n.connect(delay); };
    function osc({type='square',f0=440,f1=440,dur=.15,gain=.8,start=0}){ const o=ctx.createOscillator(); o.type=type; const t0=ctx.currentTime+start;
      o.frequency.setValueAtTime(f0,t0); if(f1!==f0) o.frequency.exponentialRampToValueAtTime(Math.max(40,f1),t0+dur);
      const g=ctx.createGain(); g.gain.setValueAtTime(.0001,t0); g.gain.exponentialRampToValueAtTime(gain,t0+.01); g.gain.exponentialRampToValueAtTime(.0001,t0+dur);
      o.connect(g); chain(g); o.start(t0); o.stop(t0+dur+.02); }
    function noise({dur=.2,lp=12000,hp=200,gain=.5,start=0}){ const N=Math.max(1,Math.floor(ctx.sampleRate*dur)); const b=ctx.createBuffer(1,N,ctx.sampleRate); const d=b.getChannelData(0);
      for(let i=0;i<N;i++) d[i]=(Math.random()*2-1); const src=ctx.createBufferSource(); src.buffer=b; const g=ctx.createGain(); g.gain.value=gain;
      const lpf=ctx.createBiquadFilter(); lpf.type='lowpass'; lpf.frequency.value=lp; const hpf=ctx.createBiquadFilter(); hpf.type='highpass'; hpf.frequency.value=hp;
      src.connect(hpf); hpf.connect(lpf); lpf.connect(g); chain(g); const t0=ctx.currentTime+start; src.start(t0); src.stop(t0+dur); }
    const lever=()=>{ noise({dur:.09,lp:8000,hp:1000,gain:.35}); osc({type:'triangle',f0:220,f1:160,dur:.10,gain:.7}); };
    const whoosh=()=>{ for(let i=0;i<11;i++) osc({type:'sawtooth',f0:220+i*36,f1:260+i*44,dur:.06,gain:.35,start:i*.045}); };
    const tick=()=>osc({type:'square',f0:1200,f1:1000,dur:.03,gain:.36});
    const clack=()=>{ noise({dur:.05,lp:5000,hp:1200,gain:.33}); osc({type:'square',f0:300,f1:240,dur:.05,gain:.28}); };
    const small=()=>[660,880].forEach((f,i)=>osc({type:'triangle',f0:f,f1:f*1.02,dur:.16,gain:.58,start:i*.09}));
    const win=()=>[523,659,783,1046].forEach((f,i)=>osc({type:'triangle',f0:f,f1:f*1.015,dur:.18,gain:.65,start:i*.1}));
    const mega=()=>{ for(let i=0;i<12;i++) osc({type:'sawtooth',f0:300+i*45,f1:420+i*60,dur:.09,gain:.6,start:i*.06}); };
    const lose=()=>[220,196].forEach((f,i)=>osc({type:'sine',f0:f,f1:f*.98,dur:.2,gain:.42,start*i*.08}));
    return {lever,whoosh,tick,clack,small,win,mega,lose}; })();

  /* ---------- Particles ---------- */
  let particles=[];
  const rand=(a,b)=>a+Math.random()*(b-a);
  const ro=new ResizeObserver(()=>{ const r=stage.getBoundingClientRect();
    fx.width=r.width*devicePixelRatio; fx.height=r.height*devicePixelRatio;
    fx.style.width=r.width+'px'; fx.style.height=r.height+'px';
    fxc.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);
  }); ro.observe(stage);
  function spawnFX(strength){
    const rect=stage.getBoundingClientRect(), cx=rect.width/2, cy=rect.height*0.34;
    const count=Math.round(30+strength*140);
    for(let i=0;i<count;i++){ const hue=Math.random(); const col=hue<.33?'rgba(0,229,255,':(hue<.66?'rgba(255,47,211,':'rgba(137,255,0,');
      particles.push({x:cx,y:cy,vx:rand(-2-strength*2,2+strength*2),vy:rand(-3-strength*3,-1-strength*1),
        life:rand(.7,1.6)+strength*.7, age:0, size:rand(2,4)+strength*2, col}); }
  }
  let last=performance.now(); (function loop(ts){ const dt=Math.max(.001,Math.min(.033,(ts-last)/1000)); last=ts;
    fxc.clearRect(0,0,fx.width,fx.height);
    particles=particles.filter(p=>p.age<p.life);
    for(const p of particles){ p.age+=dt; p.vy+=4*dt; p.x+=p.vx; p.y+=p.vy; const t=Math.min(1,p.age/p.life); fxc.fillStyle=p.col+(1-t)*0.9+')';
      fxc.beginPath(); fxc.arc(p.x,p.y,p.size*(1+.4*(1-t)),0,Math.PI*2); fxc.fill(); }
    requestAnimationFrame(loop); })(last);

  /* ---------- Symbols & RTP scaling ---------- */
  const symbols=[ {ch:'üçí',w:22,p:5},{ch:'üçã',w:22,p:4},{ch:'üîî',w:16,p:8},{ch:'‚≠ê',w:12,p:12},{ch:'üíé',w:7,p:25},{ch:'7Ô∏è‚É£',w:4,p:60},{ch:'üåà',w:8,p:0,wild:true} ];
  // ‚Üë bumped 3-kind pays slightly to make wins feel better (RTP scaler will keep the chosen edge)

  const weighted=[]; symbols.forEach(s=>{ for(let i=0;i<s.w;i++) weighted.push(s); });
  const pick=()=>weighted[(Math.random()*weighted.length)|0];

  function evalCombo(a,b,c){
    const arr=[a,b,c], wilds=arr.filter(x=>x.wild).length, bases=arr.filter(x=>!x.wild);
    const counts={}; for(const s of bases) counts[s.ch]=(counts[s.ch]||0)+1;

    // All-wilds pays as a real 3-kind (use 7Ô∏è‚É£ level by default)
    if (wilds === 3) return { mult: 60, tag: '3kind-wild' };

    // 3-kind (wilds can complete)
    for(const ch in counts){ if(counts[ch]+wilds>=3){ const sym=bases.find(x=>x.ch===ch); return { mult: sym.p, tag:'3kind' }; } }
    // 2-kind (wilds can complete)
    for(const ch in counts){ if(counts[ch]+wilds>=2) return { mult: 0.6, tag:'2kind' }; }

    // consolation if a ‚Äúhigh‚Äù appears
    if (arr.some(s=>['‚≠ê','üíé','7Ô∏è‚É£'].includes(s.ch))) return { mult: 0.25, tag:'single-high' }; // tiny, but a bit nicer
    return { mult: 0, tag:'lose' };
  }

  function baseRTP(){ const n=weighted.length; let E=0; for(let i=0;i<n;i++)for(let j=0;j<n;j++)for(let k=0;k<n;k++)E+=evalCombo(weighted[i],weighted[j],weighted[k]).mult; return E/(n*n*n); }
  const BASE_RTP=baseRTP();
  const clamp=(n,a,b)=>Math.max(a,Math.min(b,n));
  const targetEdge=()=>clamp(BASE_EDGE+(+state.edgeAdj||0),-95,95);
  const targetRTP=()=>1-targetEdge()/100;               // can exceed 1 when edge is negative
  const scaleMult=()=>clamp(targetRTP()/BASE_RTP,0.05,3); // scaler maintains chosen edge

  /* ---------- UI helpers ---------- */
  const fmt=n=>n.toLocaleString();
  function sync(){
    creditsEl.textContent=fmt(state.credits); highEl.textContent=fmt(state.high);
    spinsEl.textContent=fmt(state.spins); betInput.value=state.bet;
    edgeSlider.value=state.edgeAdj; baseEdgeLabel.textContent=`${BASE_EDGE}%`;
    edgeAdjLabel.textContent=`${(+state.edgeAdj).toFixed(1)}%`;
    edgeLabel.textContent=`${(targetEdge()).toFixed(1)}%`;
    rtpLabel.textContent=`${(targetRTP()*100).toFixed(1)}%`;
  }
  function setMsg(t){ msgEl.innerHTML=t||''; }
  function flash(el){ el.classList.remove('flash'); void el.offsetWidth; el.classList.add('flash'); }

  /* ---------- Controls ---------- */
  function setBet(v){ state.bet=clamp(Math.round(v)||1,1,100000); save(); sync(); }
  betUp.addEventListener('click',()=>setBet(state.bet+5));
  betDown.addEventListener('click',()=>setBet(state.bet-5));
  maxBtn.addEventListener('click',()=>setBet(Math.min(state.credits,100000)));
  betInput.addEventListener('change',()=>setBet(betInput.value));
  betInput.addEventListener('focus',e=>e.target.select());

  bonusBtn.addEventListener('click',()=>{ const CD=120000, amt=50, ready=now()-state.lastBonus>=CD;
    if(ready){ state.credits+=amt; state.lastBonus=now(); setMsg(`Bonus +${amt} credits! ‚ú®`); flash(stage); save(); sync(); }
    else{ const left=Math.ceil((CD-(now()-state.lastBonus))/1000); setMsg(`Bonus ready in ${left}s‚Ä¶`); }});

  oddsBtn.addEventListener('click',()=>sheet.classList.add('open'));
  closeSheet.addEventListener('click',()=>sheet.classList.remove('open'));
  edgeSlider.addEventListener('input',()=>{ state.edgeAdj=clamp(parseFloat(edgeSlider.value)||0,-SLIDER_RANGE,SLIDER_RANGE); save(); sync(); });
  edgeReset.addEventListener('click',()=>{ state.edgeAdj=0; save(); sync(); });

  $('resetBtn').addEventListener('click',()=>{ if(confirm('Reset all progress?')){ storage.removeItem(SAVE_KEY); state=defaultState(); save(); sync();
    r[0].textContent='üçí'; r[1].textContent='üçã'; r[2].textContent='üîî'; setMsg('Progress reset.'); flash(stage); } });

  /* ---------- Spin ---------- */
  let spinning=false;
  function spin(){
    if(spinning) return;
    if(state.bet>state.credits){ setMsg('Not enough credits.'); AudioKit.lose(); return; }

    AudioKit.lever(); AudioKit.whoosh();
    setMsg('Spinning‚Ä¶'); spinning=true; state.credits-=state.bet; save(); sync();

    const stop=[760,1080,1420], reels=r, roll=[null,null,null], ints=[];
    for(let i=0;i<3;i++){ const id=setInterval(()=>{ const s=pick(); reels[i].textContent=s.ch; AudioKit.tick(); }, Math.max(40,90-i*10)); ints.push(id); }
    stop.forEach((d,i)=>setTimeout(()=>{ clearInterval(ints[i]); const s=pick(); reels[i].textContent=s.ch; roll[i]=s; flash(reels[i]); AudioKit.clack();
      if(i===2){
        let payout = 0;

        // Warm-up: guaranteed net-positive over first 5 spins
        if (meta.warmupIndex < WARMUP_PLAN.length){
          const multWarm = WARMUP_PLAN[meta.warmupIndex++];
          saveMeta();
          const raw = state.bet * multWarm;
          const base = Math.floor(raw), frac = raw - base;
          payout = base + (Math.random() < frac ? 1 : 0);
        } else {
          // Normal path: evaluate + RTP scaling + unbiased rounding
          const {mult} = evalCombo(roll[0],roll[1],roll[2]);
          const raw = state.bet * mult * scaleMult();
          const base = Math.floor(raw), frac = raw - base;
          payout = base + (Math.random() < frac ? 1 : 0);
        }

        if(payout>0){
          state.credits+=payout;
          const strength=clamp((payout/state.bet - 0.2)/50,0,1);
          spawnFX(strength);
          if(payout>=state.bet*12) AudioKit.mega(); else if(payout>=state.bet*2) AudioKit.win(); else AudioKit.small();
          setMsg(`You won ${payout.toLocaleString()} credits! üéâ`);
        }else{
          AudioKit.lose(); setMsg('So close!');
        }

        state.spins++; if(state.credits>state.high) state.high=state.credits;
        save(); sync(); spinning=false;
      }
    }, d));
  }

  spinBtn.addEventListener('click', spin);
  document.addEventListener('keydown', e=>{ if(e.code==='Space'){ e.preventDefault(); spin(); } });

  /* ---------- Boot ---------- */
  (function boot(){ if(state.credits<=0){ state.credits=100; setMsg('Here are 100 credits to keep playing!'); }
    sync(); setTimeout(()=>{ stage.classList.add('flash'); },350); })();

})();
</script>
</body>
</html>
